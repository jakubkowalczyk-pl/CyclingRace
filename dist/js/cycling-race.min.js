/*!
* CyclingRace v1.0.0
* http://jgallery.jakubkowalczyk.pl/
*
* Date: 2015-08-25
*/
!function(){"use strict";var a=angular.module("cyclingRace",[]);a.factory("cyclingRace.Bike",["cyclingRace.Pedal","cyclingRace.Control","$interval",function(a,b,c){var d=function(){this.speed=0,this.crankSpeed=0,this.leftPedal=new a,this.rightPedal=new a({position:180}),this.control=new b({bike:this}),this.pressingLeftPedal=null,this.pressingRightPedal=null,this.pressingInterval=40};return d.prototype={constructor:d,pressLeftPedal:function(){var a=this;this.pressingRightPedal?this.stopPressPedals():this.pressingLeftPedal||(this.pressingLeftPedal=c(function(){a.rotateCrank(a.leftPedal)},this.pressingInterval))},stopPressLeftPedal:function(){c.cancel(this.pressingLeftPedal),this.pressingLeftPedal=null,this.crankSpeed=0},pressRightPedal:function(){var a=this;this.pressingLeftPedal?this.stopPressPedals():this.pressingRightPedal||(this.pressingRightPedal=c(function(){a.rotateCrank(a.rightPedal)},this.pressingInterval))},stopPressRightPedal:function(){c.cancel(this.pressingRightPedal),this.pressingRightPedal=null,this.crankSpeed=0},rotateCrank:function(b){if(b.position<a.POSITION_DOWN){var c=10;this.crankSpeed=c/360*6e4/this.pressingInterval,this.leftPedal.position+=c,this.rightPedal.position+=c,this.leftPedal.position>=360&&(this.leftPedal.position=0),this.rightPedal.position>=360&&(this.rightPedal.position=0)}else this.crankSpeed=0},stopPressPedals:function(){this.stopPressLeftPedal(),this.stopPressRightPedal()}},d}]),a.factory("cyclingRace.Biker",function(){var a=function(a){this.name=a.name,this.bike=a.bike};return a.prototype={constructor:a},a}),a.factory("cyclingRace.Control",function(){var a=function(a){angular.element(document).bind("keydown",function(b){switch(b.keyCode){case 37:a.bike.pressLeftPedal();break;case 39:a.bike.pressRightPedal()}}).bind("keyup",function(b){switch(b.keyCode){case 37:a.bike.stopPressLeftPedal();break;case 39:a.bike.stopPressRightPedal()}})};return a.prototype={constructor:a},a}),a.factory("cyclingRace.Pedal",function(){var a=function(a){a=a||{},this.position=a.position||0};return a.POSITION_UP=0,a.POSITION_DOWN=180,a.prototype={constructor:a},a}),a.directive("cyclingRace",["cyclingRace.Biker","cyclingRace.Bike",function(a,b){return{link:function(c){c.bikers=[],c.bikers.push(new a({name:"Player1",bike:new b}))}}}])}();